from pathlib import Path

# Contenido del archivo de texto en R
r_template_text = """
# ğŸ§¹ Plantilla de Limpieza de Datos â€“ Template Reutilizable (R)

# ğŸ“‚ Nombre del dataset: ______________
# ğŸ“… Fecha de adquisiciÃ³n: YYYY-MM-DD
# ğŸŒ Fuente: ______________
# ğŸ¯ Objetivo del dataset: ______________________________

# ---------------------------------------------
# ğŸ§¾ Paso 1 â€“ Carga inicial

# Cargar librerÃ­as necesarias
library(tidyverse)

# Leer datos
df_raw <- read_csv("ruta/del/dataset.csv")

# Copia para limpieza
df <- df_raw

# ---------------------------------------------
# ğŸ” Paso 2 â€“ ExploraciÃ³n inicial

# Dimensiones
dim(df)

# Vista previa
head(df)

# Estructura de columnas
str(df)

# Resumen estadÃ­stico
summary(df)

# ---------------------------------------------
# ğŸš© Paso 3 â€“ DetecciÃ³n de problemas

# Revisar valores NA
colSums(is.na(df))

# Revisar duplicados
sum(duplicated(df))

# ---------------------------------------------
# ğŸ› ï¸ Paso 4 â€“ Limpieza de datos

## 4.1 Eliminar o imputar NA

# Eliminar filas con email NA
df <- df %>% filter(!is.na(email))

# Imputar edad con media
df$edad[is.na(df$edad)] <- mean(df$edad, na.rm = TRUE)

## 4.2 Eliminar duplicados
df <- df %>% distinct()

## 4.3 ConversiÃ³n de tipos
df$fecha <- as.Date(df$fecha)
df$ingresos <- as.numeric(df$ingresos)

## 4.4 NormalizaciÃ³n de texto
df$genero <- tolower(trimws(df$genero))
df$genero <- recode(df$genero,
                    "m" = "masculino",
                    "masculino" = "masculino",
                    "f" = "femenino",
                    "fem" = "femenino")

## 4.5 Crear columnas nuevas
df$edad_calc <- as.numeric(format(Sys.Date(), "%Y")) - as.numeric(format(df$fecha_nacimiento, "%Y"))

# ---------------------------------------------
# âœ… Paso 5 â€“ VerificaciÃ³n final

# Comprobar NA restantes
colSums(is.na(df))

# Estructura final
str(df)

# Vista rÃ¡pida
head(df)

# ---------------------------------------------
# ğŸ“¤ Paso 6 â€“ Exportar datos limpios

write_csv(df, "ruta/output/dataset_clean.csv")

# ---------------------------------------------
# ğŸ“ Resumen de Cambios

# 1. EliminaciÃ³n de NA: columnas email, edad
# 2. ImputaciÃ³n: edad, ingresos
# 3. Duplicados eliminados
# 4. Texto normalizado: genero
# 5. Nuevas columnas: edad_calc
"""

# Guardar archivo de texto
file_path = Path("Plantilla_Limpieza_Datos_R.txt")
file_path.write_text(r_template_text)

print("Archivo 'Plantilla_Limpieza_Datos_R.txt' creado exitosamente.")
